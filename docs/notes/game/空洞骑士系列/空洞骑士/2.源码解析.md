---
title: æºç è§£æ
createTime: 2025/12/17 16:25:36
permalink: /notes/games/hollow_knight/little_knight/code-parse/
---

å¯ä»¥ä½¿ç”¨æœ¬é¼ é¼ å¼€å‘çš„å­˜æ¡£è§£æå·¥å…·åˆ†æå®Œæˆåº¦ [å­˜æ¡£è§£æ](https://nov1ce-lee.github.io/hollowKnightSaveParser)

### å®Œæ•´å®Œæˆåº¦å­—æ®µ
é™„ä¸Šä»æ¸¸æˆAssembly.dllä¸­è§£æå‡ºçš„å®Œæ•´çš„å®Œæˆåº¦å­—æ®µğŸ‘‡

```c# :collapsed-lines
public void CountGameCompletion()
{
    this.completionPercentage = 0f;
    this.CountCharms();
    this.completionPercentage += (float)this.charmsOwned;
    if (this.killedFalseKnight)
    {
        this.completionPercentage += 1f;
    }
    if (this.hornet1Defeated)
    {
        this.completionPercentage += 1f;
    }
    if (this.hornetOutskirtsDefeated)
    {
        this.completionPercentage += 1f;
    }
    if (this.killedMantisLord)
    {
        this.completionPercentage += 1f;
    }
    if (this.killedMageLord)
    {
        this.completionPercentage += 1f;
    }
    if (this.killedDungDefender)
    {
        this.completionPercentage += 1f;
    }
    if (this.killedBlackKnight)
    {
        this.completionPercentage += 1f;
    }
    if (this.killedInfectedKnight)
    {
        this.completionPercentage += 1f;
    }
    if (this.killedMimicSpider)
    {
        this.completionPercentage += 1f;
    }
    if (this.killedMegaJellyfish)
    {
        this.completionPercentage += 1f;
    }
    if (this.killedTraitorLord)
    {
        this.completionPercentage += 1f;
    }
    if (this.killedJarCollector)
    {
        this.completionPercentage += 1f;
    }
    if (this.killedBigFly)
    {
        this.completionPercentage += 1f;
    }
    if (this.killedMawlek)
    {
        this.completionPercentage += 1f;
    }
    if (this.killedHiveKnight)
    {
        this.completionPercentage += 1f;
    }
    if (this.colosseumBronzeCompleted)
    {
        this.completionPercentage += 1f;
    }
    if (this.colosseumSilverCompleted)
    {
        this.completionPercentage += 1f;
    }
    if (this.colosseumGoldCompleted)
    {
        this.completionPercentage += 1f;
    }
    if (this.killedGhostAladar)
    {
        this.completionPercentage += 1f;
    }
    if (this.killedGhostHu)
    {
        this.completionPercentage += 1f;
    }
    if (this.killedGhostXero)
    {
        this.completionPercentage += 1f;
    }
    if (this.killedGhostMarkoth)
    {
        this.completionPercentage += 1f;
    }
    if (this.killedGhostNoEyes)
    {
        this.completionPercentage += 1f;
    }
    if (this.killedGhostMarmu)
    {
        this.completionPercentage += 1f;
    }
    if (this.killedGhostGalien)
    {
        this.completionPercentage += 1f;
    }
    this.completionPercentage += (float)this.fireballLevel;
    this.completionPercentage += (float)this.quakeLevel;
    this.completionPercentage += (float)this.screamLevel;
    if (this.hasCyclone)
    {
        this.completionPercentage += 1f;
    }
    if (this.hasDashSlash)
    {
        this.completionPercentage += 1f;
    }
    if (this.hasUpwardSlash)
    {
        this.completionPercentage += 1f;
    }
    if (this.hasDash)
    {
        this.completionPercentage += 2f;
    }
    if (this.hasWalljump)
    {
        this.completionPercentage += 2f;
    }
    if (this.hasDoubleJump)
    {
        this.completionPercentage += 2f;
    }
    if (this.hasAcidArmour)
    {
        this.completionPercentage += 2f;
    }
    if (this.hasSuperDash)
    {
        this.completionPercentage += 2f;
    }
    if (this.hasShadowDash)
    {
        this.completionPercentage += 2f;
    }
    if (this.hasKingsBrand)
    {
        this.completionPercentage += 2f;
    }
    if (this.lurienDefeated)
    {
        this.completionPercentage += 1f;
    }
    if (this.hegemolDefeated)
    {
        this.completionPercentage += 1f;
    }
    if (this.monomonDefeated)
    {
        this.completionPercentage += 1f;
    }
    if (this.hasDreamNail)
    {
        this.completionPercentage += 1f;
    }
    if (this.dreamNailUpgraded)
    {
        this.completionPercentage += 1f;
    }
    if (this.mothDeparted)
    {
        this.completionPercentage += 1f;
    }
    this.completionPercentage += (float)this.nailSmithUpgrades;
    this.completionPercentage += (float)(this.maxHealthBase - 5);
    int mpreserveMax = this.MPReserveMax;
    if (mpreserveMax != 33)
    {
        if (mpreserveMax != 66)
        {
            if (mpreserveMax == 99)
            {
                this.completionPercentage += 3f;
            }
        }
        else
        {
            this.completionPercentage += 2f;
        }
    }
    else
    {
        this.completionPercentage += 1f;
    }
    if (this.killedGrimm)
    {
        this.completionPercentage += 1f;
    }
    if (this.killedNightmareGrimm || this.destroyedNightmareLantern)
    {
        this.completionPercentage += 1f;
    }
    if (this.hasGodfinder)
    {
        this.completionPercentage += 1f;
    }
    if (this.bossDoorStateTier1.completed)
    {
        this.completionPercentage += 1f;
    }
    if (this.bossDoorStateTier2.completed)
    {
        this.completionPercentage += 1f;
    }
    if (this.bossDoorStateTier3.completed)
    {
        this.completionPercentage += 1f;
    }
    if (this.bossDoorStateTier4.completed)
    {
        this.completionPercentage += 1f;
    }
}
```

---

### å­—æ®µåˆ†æ
#### 1. é¢å…·ç¢ç‰‡
é¢å…·å®Œæˆåº¦æ˜¯æ ¹æ®æœ€å¤§ç”Ÿå‘½å€¼å‡å»åˆå§‹ç”Ÿå‘½å€¼å¾—åˆ°çš„
```c# :no-line-numbers
this.completionPercentage += (float)(this.maxHealthBase - 5);
```
å› æ­¤åœ¨è§£ææ¸¸æˆå­˜æ¡£æ—¶ï¼Œå¯ä»¥è·å–`playerData.maxHealthBase - 5`çš„å€¼ä½œä¸ºé¢å…·å®Œæˆåº¦

#### 2. å®¹å™¨ç¢ç‰‡
å®¹å™¨å®Œæˆåº¦åˆ™æ˜¯æ ¹æ®çµé­‚å‚¨å¤‡é‡çš„æœ€å¤§å€¼å¾—åˆ°çš„
```c# :no-line-numbers 
int mpreserveMax = this.MPReserveMax;
if (mpreserveMax != 33)
{
    if (mpreserveMax != 66)
    {
        if (mpreserveMax == 99)
        {
            this.completionPercentage += 3f;
        }
    }
    else
    {
        this.completionPercentage += 2f;
    }
}
else
{
    this.completionPercentage += 1f;
}
```
é‚£ä¹ˆå®¹å™¨å®Œæˆåº¦å°±å¯ä»¥é€šè¿‡`playerData.MPReserveMax / 33 `çš„å€¼æ¥è·å–

#### 3. æ ¼æ—å‰§å›¢
è¿™ä¸ªå¾ˆå¥½ç†è§£ï¼Œå‡»è´¥==æ ¼æ—å›¢é•¿==å¯ä»¥è·å¾— 1 å®Œæˆåº¦   
åç»­å¯ä»¥é€‰æ‹©æ‰“è´¥==æ¢¦é­‡ä¹‹ç‹æ ¼æ—==ï¼Œæˆ–æ˜¯==æ‘§æ¯æ¢¦é­‡ä¹‹ç¯è¾¾æˆæ”¾é€æ ¼æ—å‰§å›¢==è·å¾— 1 å®Œæˆåº¦
```c# :no-line-numbers
if (this.killedGrimm)
{
    this.completionPercentage += 1f;
}
if (this.killedNightmareGrimm || this.destroyedNightmareLantern)
{
    this.completionPercentage += 1f;
}
```
